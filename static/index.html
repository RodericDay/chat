<!DOCTYPE html>
<head>
<title>Lab</title>
<link rel="icon" href="/pico.png" type="image/x-icon" />
<link rel="stylesheet" href="/style.css" />
<meta name="viewport" content="width=device-width, initial-scale=.9, maximum-scale=.8">
<script src="https://cdn.jsdelivr.net/npm/reconnecting-websocket@4.4.0/dist/reconnecting-websocket-iife.min.js"></script>
<script src="https://unpkg.com/mithril/mithril.js"></script>
<script type="module" src="/app.js" defer></script>
<script>
const State = Object.seal({
    myWs: undefined,
    myStream: undefined,
    sharedScreen: undefined,
    peers: {},
    posts: [],
    errors: [],
    uploads: {},

    get sharedScreenIsLocal() {
        return !!this.sharedScreen?.getTracks().every(track => !track.label.includes('remote'))
    },

    get username() { return localStorage.getItem('username') },
    set username(value) { localStorage.setItem('username', value) },

    get audio() { return localStorage.getItem('audio') === 'true' },
    set audio(value) { localStorage.setItem('audio', value) },

    get video() { return localStorage.getItem('video') === 'true' },
    set video(value) { localStorage.setItem('video', value) },

    get bars() { return localStorage.getItem('bars') !== 'false' },
    set bars(value) { localStorage.setItem('bars', value) },

    get chat() { return localStorage.getItem('chat') === 'true' },
    set chat(value) { localStorage.setItem('chat', value) },

    get debug() { return localStorage.getItem('debug') === 'true' },
    set debug(value) { localStorage.setItem('debug', value) },

})
</script>
</head>

<body></body>
